# =========================
# NEXO 2026 - .env.example
# =========================

# ---------- Core ----------
NEXO_PROFILE=br_default_v1
NEXO_AUDIT_PATH=logs/audit_records.jsonl
NEXO_AUDIT_RETENTION=5000

NEXO_AUTH_WINDOW_MS=60000
NEXO_REPLAY_TTL_MS=120000
NEXO_REPLAY_MAX_KEYS=100000

NEXO_RATE_LIMIT_WINDOW_MS=60000
NEXO_RATE_LIMIT_IP=600
NEXO_RATE_LIMIT_USER=300

# provider: none | vault | azure | gcp | aws
NEXO_SECRET_PROVIDER=none

# =========================
# Fallback local (dev)
# =========================
NEXO_HMAC_SECRET=dev-secret-active
NEXO_HMAC_SECRET_PREV=
NEXO_HMAC_KEY_ID=active
NEXO_HMAC_KEY_ID_PREV=previous

# Optional file-based secrets
# NEXO_HMAC_SECRET_FILE=/run/secrets/nexo_hmac_secret
# NEXO_HMAC_SECRET_PREV_FILE=/run/secrets/nexo_hmac_secret_prev
# NEXO_HMAC_KEY_ID_FILE=/run/secrets/nexo_hmac_key_id
# NEXO_HMAC_KEY_ID_PREV_FILE=/run/secrets/nexo_hmac_key_id_prev

# =========================
# Vault (NEXO_SECRET_PROVIDER=vault)
# =========================
# NEXO_VAULT_ADDR=https://vault.internal:8200
# NEXO_VAULT_TOKEN=...
# NEXO_VAULT_MOUNT=secret
# NEXO_VAULT_PATH=nexo/prod
# NEXO_VAULT_TIMEOUT_MS=2000
# NEXO_VAULT_FIELD_ACTIVE_SECRET=hmac_secret
# NEXO_VAULT_FIELD_PREV_SECRET=hmac_secret_prev
# NEXO_VAULT_FIELD_ACTIVE_KEY_ID=hmac_key_id
# NEXO_VAULT_FIELD_PREV_KEY_ID=hmac_key_id_prev

# =========================
# Azure (NEXO_SECRET_PROVIDER=azure)
# =========================
# NEXO_AZURE_VAULT_URL=https://myvault.vault.azure.net
# NEXO_AZURE_API_VERSION=7.4
# NEXO_AZURE_TIMEOUT_MS=2000
# NEXO_AZURE_SECRET_ACTIVE=nexo-hmac-secret-active
# NEXO_AZURE_SECRET_PREV=nexo-hmac-secret-prev
# NEXO_AZURE_SECRET_KEY_ID_ACTIVE=nexo-hmac-key-id-active
# NEXO_AZURE_SECRET_KEY_ID_PREV=nexo-hmac-key-id-prev
#
# One option:
# NEXO_AZURE_ACCESS_TOKEN=...
# Or:
# NEXO_AZURE_ACCESS_TOKEN_FILE=/run/secrets/azure_access_token
#
# Managed Identity option:
# NEXO_AZURE_USE_MANAGED_IDENTITY=true
# NEXO_AZURE_MANAGED_IDENTITY_CLIENT_ID=
# NEXO_AZURE_IMDS_ENDPOINT=http://169.254.169.254/metadata/identity/oauth2/token

# =========================
# GCP (NEXO_SECRET_PROVIDER=gcp)
# =========================
# NEXO_GCP_PROJECT_ID=my-gcp-project
# NEXO_GCP_TIMEOUT_MS=2000
# NEXO_GCP_SECRET_ACTIVE=nexo-hmac-secret-active
# NEXO_GCP_SECRET_PREV=nexo-hmac-secret-prev
# NEXO_GCP_SECRET_KEY_ID_ACTIVE=nexo-hmac-key-id-active
# NEXO_GCP_SECRET_KEY_ID_PREV=nexo-hmac-key-id-prev
#
# One option:
# NEXO_GCP_ACCESS_TOKEN=...
# Or:
# NEXO_GCP_ACCESS_TOKEN_FILE=/run/secrets/gcp_access_token
#
# Metadata token option:
# NEXO_GCP_USE_METADATA_TOKEN=true
# NEXO_GCP_METADATA_TOKEN_URL=http://metadata.google.internal/computeMetadata/v1/instance/service-accounts/default/token

# =========================
# AWS (NEXO_SECRET_PROVIDER=aws)
# =========================
# NEXO_AWS_REGION=us-east-1
# NEXO_AWS_SECRET_ID=nexo/prod/hmac_bundle
# NEXO_AWS_RUNTIME_TIMEOUT_MS=5000
# NEXO_AWS_FIELD_ACTIVE_SECRET=hmac_secret
# NEXO_AWS_FIELD_PREV_SECRET=hmac_secret_prev
# NEXO_AWS_FIELD_ACTIVE_KEY_ID=hmac_key_id
# NEXO_AWS_FIELD_PREV_KEY_ID=hmac_key_id_prev
